# Кейс-задача №4: «Web-версия книжного магазина» — Аналитический отчёт

## Анализ реализации (≥7 пунктов)
1. **Два интерфейса.** Пользовательский фронт — каталог, карточка книги, оформление покупки/аренды, список заказов. Административный — Django Admin для полного управления данными + простая страница `/dashboard/` для быстрого мониторинга (низкие остатки, ближайшие возвраты).
2. **Моделирование домена.** Выделены сущности `Author`, `Category`, `Book` и торговые сущности `Order`, `OrderItem`. Для книг присутствуют поля цен, статусы доступности и базовый остаток. В `OrderItem` хранится вид операции (покупка/аренда), цена, и окна аренды.
3. **Доступность и учёт остатков.** Доступные экземпляры рассчитываются как `available_copies - активные_аренды`. Покупка уменьшает `available_copies`. Для аренды экземпляр считается занятым до `end_date`.
4. **Фильтры и сортировка.** Каталог поддерживает фильтрацию по категории/автору/году и сортировку по этим же полям. Запросы оптимизированы `select_related`.
5. **Сроки аренды.** Поддержаны фиксированные периоды: 2 недели / 1 месяц / 3 месяца, которые автоматически вычисляют `start_date` и `end_date`. Цены задаются отдельно для каждого срока.
6. **Напоминания об окончании аренды.** Реализована management-команда `send_rental_reminders`, отсылающая письма за 3 дня, за 1 день и после просрочки. Для продакшена предполагается планировщик (cron/CI/Celery beat).
7. **Безопасность и права.** Любой пользователь может просматривать каталог. Оформление покупки/аренды доступно только после входа. `/dashboard/` закрыт декоратором `@staff_member_required`. Админка — только для суперпользователей/сотрудников.
8. **UX и структура.** Единый базовый шаблон, тёмная тема, понятные кнопки действий, минимум кликов до целевого действия. Раздел «Мои заказы» агрегирует историю покупок и аренд.
9. **Демо-данные.** Команда `seed_demo` создаёт админа и пользователей, авторов, категории, популярные книги — удобно для проверки и защиты.

## Рекомендации по улучшению
1. **Оплата.** Интегрировать платёжный провайдер (например, ЮKassa/Stripe), добавить статусы заказов и вебхуки.
2. **Продления аренды.** Ввести продление и автоматический пересчёт периодов с доплатой.
3. **Отдельные экземпляры книг.** Для строгого учёта — модель `BookCopy` и резервы на период.
4. **Поиск.** Полнотекстовый поиск по названию/описанию (PostgreSQL + `django.contrib.postgres.search`). 
5. **Уведомления.** E-mail + Telegram-бот/Push. Для периодики — Celery + Celery Beat с очередью задач.
6. **Витрина.** Обложки, рейтинги, отзывы, рекомендации по категориям/авторам.
7. **Тестирование.** Unit-тесты моделей (арифметика доступности, вычисление дат), вью и e2e-тесты на критические сценарии.
